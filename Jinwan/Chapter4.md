## 4장 서버 사이드 렌더링

### 싱글 페이지 어플리케이션 (SPA)

렌더링과 라우팅에 필요한 대부분의 기능을 서버가 아닌 브라우저의 자바스크립트에 의존하는 방식이다. 최초 첫 페이지 데이터를 불러온 후 페이지 전환 작업이 모두 자바스크립트와 부라우저의 `history.pushState`와 `history.replaceState`로 이루어진다.

페이지 전환을 모두 자바스크립트로 한다면 최초 리소스 다운로드 이후 페이지 전환에는 리소스를 추가로 다운로드할 필요가 없다. 이로 인해 웹 개발 스택이 LAMP 스택에서 JAM 스택으로 변화하기 시작했다.

JAM 스택의 인기가 높아지고 Node.js가 고도화되면서 MEAN, MERN 스택이 등장했다.

이런 싱글 페이지 어플리케이션은 자바스크립트의 규모를 커지게 만들었고, 문제가 생기지 않을까 우려의 목소리가 나왔다. 그래도 인터넷 속도가 빨라지고 하드웨어 성능이 발전하면서 자연스럽게 해결될 것이라 기대하기도 한다.

### 서버 사이드 렌더링

싱글 페이지 어플리케이션은 하나의 페이지에서만 렌더링을 수행하고 자바스크립트를 통해 페이지 전환을 보여주지만, 이로 인해 최초 로딩 시간이 길어지게 된다.

서버사이드 렌더링은 서버에서 페이지를 렌더링 해 사용자에게 제공하는 방식이다. 그로 인해 서버 사이드 렌더링은 비교적 안정적인 렌더링이 가능하다.

#### 장점

1. 최초 페이지 진입이 비교적 빠르다.

2. 검색 엔진과 SNS 공유 등 메타데이터 제공이 쉽다.

3. CLS를 줄일 수 있다.

4. 사용자 디바이스 성능에 비교적 자유롭다.

5. 보안에 좀 더 안전하다.

#### 단점

1. 소스코드를 작성할 때 항상 서버를 고려해야 한다.

2. 적절한 서버가 구축돼 있어야 한다.

3. 서비스 지연에 따른 문제

### 현대의 서버 사이드 렌더링

LAMP 스택은 모든 페이지 빌드를 서버에서 렌더링 해 초기 진입이 빠르다. 하지만 이후 라우팅이 발생할 때 마찬가지로 서버에 의존해 라우팅이 느리다.

요즘 서버 사이드 렌더링은 서버에서 완성된 HTML을 내려주고 라우팅 시에넌 서버에서 내려받은 자바스크립트를 바탕으로 마치 싱글 체이지 어플리케이션처럼 작동한다.

### react api로 서버 사이드 렌더링 하기

#### renderToString

컴포넌트를 렌더링 해 HTML 문자열로 반환

#### renderToStaticMarkup

위와 유사하지만 data-reactroot와 같이 리액트에서만 사용하는 DOM 속성을 만들지 않는다.

#### renderToNodeStream

결과물은 `renderToString`과 동일하지만 브라우저에서 사용할 수 없다. 또한 결과물이 `string`이 아니라 `stream`이다.

#### renderToStaticNodeStream

음..

#### hydrate

렌더링된 HTML이 있다는 가정하에 이벤트를 붙이는 작업만 실행한다.

#### 서버 사이드 렌더링 예제 프로젝트

학교 인공지능 수업에서 GA 알고리즘으로 문제를 해결하는 과제를 받았는데, 이미 구현된 알고리즘을 가져다 쓰면 되는 것을 모르고 대충 만들어서 제출했던 적이 있다. 교수님이 답변한 내용이 기억이 난다.

> Don't reinvent the wheel

그냥 Next.js 쓸거다.
